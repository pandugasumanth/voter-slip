<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Voter Information Slip</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ======= GLOBAL ======= */
body {
  font-family: Arial, sans-serif;
  margin: 0;
}

/* ======= BACKGROUND (LANDING) ======= */
.page {
  min-height: 100vh;
  background: url("background.jpg") center / cover no-repeat;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px;
}

@media (max-width: 768px) {
  .page {
    background: url("background.jpg") center / cover no-repeat;
  }
}

/* ======= SEARCH CARD ======= */
.search-card {
  background: #ffffffee;
  width: 100%;
  max-width: 380px;
  border: 1px solid #000;
  padding: 10px;
}

h3 {
  text-align: center;
  margin: 6px 0;
}

select, input, button {
  width: 100%;
  padding: 6px;
  margin: 4px 0;
  font-size: 13px;
}

/* ======= RESULTS ======= */
.results {
  margin-top: 10px;
}

/* ======= SLIP ======= */
.slip {
  border: 1px solid #000;
  padding: 6px;
  margin-bottom: 10px;
  background: #fff;
}

/* ======= HEADER ======= */
.slip-header {
  text-align: center;
  border-bottom: 1px solid #000;
  margin-bottom: 6px;
  padding-bottom: 4px;
}

.slip-header .top {
  font-size: 12px;
  font-weight: bold;
}

.slip-header .candidate {
  font-size: 13px;
  font-weight: bold;
}

.slip-header .sub {
  font-size: 10px;
}

/* ======= DATA ======= */
.row {
  font-size: 11px;
  margin: 2px 0;
}

/* ======= FOOTER ======= */
.footer {
  font-size: 9px;
  text-align: center;
  margin-top: 6px;
}

/* ======= PRINT (2 INCH) ======= */
@media print {
  body * {
    visibility: hidden;
  }

  .slip, .slip * {
    visibility: visible;
  }

  .slip {
    position: absolute;
    left: 0;
    top: 0;
    width: 58mm;
    border: none;
  }

  .search-card,
  button {
    display: none;
  }
}
</style>
</head>

<body>

<div class="page">

  <div class="search-card">
    <h3>Voter Information Slip</h3>

    <select id="searchType">
      <option value="epic_no">Search by EPIC No</option>
      <option value="name">Search by Name</option>
      <option value="house_No">Search by House No</option>
      <option value="mobile_no">Search by Mobile No</option>
    </select>

    <input id="search" placeholder="Enter value">
    <button onclick="findVoter()">Search</button>

    <div id="result" class="results"></div>
  </div>

</div>

<script>
let voters = [];

/* LOAD DATA */
fetch("https://opensheet.elk.sh/1xfIMsplZ_b4X4VI6D0AKUK5sQnVPRPFFgOhgJZUgAMc/Sheet1!A1:Z")
  .then(res => res.json())
  .then(data => voters = data);

/* NORMALIZE */
function normalize(v) {
  return String(v || "").trim().toUpperCase().replace(/\s+/g, "");
}

/* SEARCH */
function findVoter() {
  const type = document.getElementById("searchType").value;
  const input = normalize(document.getElementById("search").value);
  const box = document.getElementById("result");
  box.innerHTML = "";

  const matches = voters.filter(v =>
    normalize(v[type]) === input
  );

  if (!matches.length) {
    box.innerHTML = "<p>No record found</p>";
    return;
  }

  matches.forEach(v => {
    box.innerHTML += `
      <div class="slip">
        <div class="slip-header">
          <div class="top">âœ‹ Vote for Congress</div>
          <div class="candidate">Sarilla Raja Kumari</div>
          <div class="sub">
            52 Division Candidate<br>
            Ballot Serial No: 6
          </div>
        </div>

        <div class="row"><b>Voter ID:</b> ${v.epic_no || ""}</div>
        <div class="row"><b>Name:</b> ${v.name || ""}</div>
        <div class="row"><b>${v.relation || ""}:</b> ${v.relation_name || ""}</div>
        <div class="row"><b>House No:</b> ${v.house_No || ""}</div>
        <div class="row"><b>PS:</b> ${v.ps_location || ""}</div>
        <div class="row"><b>Serial:</b> ${v.serial_no || ""}</div>
        <div class="row"><b>Age / Gender:</b> ${v.age || ""} | ${v.gender || ""}</div>

        <button onclick="printOne(this)">Print</button>

        <div class="footer">
          This is NOT an official voter slip.<br>
          Please carry valid ID for voting.
        </div>
      </div>
    `;
  });
}

/* PRINT SINGLE */
function printOne(btn) {
  const slip = btn.closest(".slip");
  const original = document.body.innerHTML;
  document.body.innerHTML = slip.outerHTML;
  window.print();
  document.body.innerHTML = original;
}
</script>

</body>
</html>
